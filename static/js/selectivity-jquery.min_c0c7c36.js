!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).selectivity=t()}(function(){return function t(e,i,n){function s(o,l){if(!i[o]){if(!e[o]){var u="function"==typeof require&&require;if(!l&&u)return u(o,!0);if(r)return r(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var h=i[o]={exports:{}};e[o][0].call(h.exports,function(t){var i=e[o][1][t];return s(i||t)},h,h.exports,t,e,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e){var i=t(10).Symbol;e.exports=i},{10:10}],2:[function(t,e){e.exports=function(t,e){for(var i=-1,n=null==t?0:t.length,s=Array(n);++i<n;)s[i]=e(t[i],i,t);return s}},{}],3:[function(t,e){var i=t(1),n=t(8),s=t(9),r="[object Null]",o="[object Undefined]",l=i?i.toStringTag:void 0;e.exports=function(t){return null==t?void 0===t?o:r:l&&l in Object(t)?n(t):s(t)}},{1:1,8:8,9:9}],4:[function(t,e){e.exports=function(t){return function(e){return null==t?void 0:t[e]}}},{}],5:[function(t,e){function i(t){if("string"==typeof t)return t;if(r(t))return s(t,i)+"";if(o(t))return a?a.call(t):"";var e=t+"";return"0"==e&&1/t==-l?"-0":e}var n=t(1),s=t(2),r=t(13),o=t(17),l=1/0,u=n?n.prototype:void 0,a=u?u.toString:void 0;e.exports=i},{1:1,13:13,17:17,2:2}],6:[function(t,e){var i=t(4)({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});e.exports=i},{4:4}],7:[function(t,e){(function(t){var i="object"==typeof t&&t&&t.Object===Object&&t;e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(t,e){var i=t(1),n=Object.prototype,s=n.hasOwnProperty,r=n.toString,o=i?i.toStringTag:void 0;e.exports=function(t){var e=s.call(t,o),i=t[o];try{t[o]=void 0;var n=!0}catch(t){}var l=r.call(t);return n&&(e?t[o]=i:delete t[o]),l}},{1:1}],9:[function(t,e){var i=Object.prototype.toString;e.exports=function(t){return i.call(t)}},{}],10:[function(t,e){var i=t(7),n="object"==typeof self&&self&&self.Object===Object&&self,s=i||n||Function("return this")();e.exports=s},{7:7}],11:[function(t,e){var i=t(14),n=t(18),s=t(19),r="Expected a function",o=Math.max,l=Math.min;e.exports=function(t,e,u){function a(e){var i=g,n=m;return g=m=void 0,I=e,w=t.apply(n,i)}function h(t){return I=t,b=setTimeout(f,e),x?a(t):w}function c(t){var i=t-I,n=e-(t-_);return O?l(n,y-i):n}function d(t){var i=t-_,n=t-I;return void 0===_||i>=e||0>i||O&&n>=y}function f(){var t=n();return d(t)?p(t):void(b=setTimeout(f,c(t)))}function p(t){return b=void 0,E&&g?a(t):(g=m=void 0,w)}function v(){var t=n(),i=d(t);if(g=arguments,m=this,_=t,i){if(void 0===b)return h(_);if(O)return b=setTimeout(f,e),a(_)}return void 0===b&&(b=setTimeout(f,e)),w}var g,m,y,w,b,_,I=0,x=!1,O=!1,E=!0;if("function"!=typeof t)throw new TypeError(r);return e=s(e)||0,i(u)&&(x=!!u.leading,y=(O="maxWait"in u)?o(s(u.maxWait)||0,e):y,E="trailing"in u?!!u.trailing:E),v.cancel=function(){void 0!==b&&clearTimeout(b),I=0,g=_=m=b=void 0},v.flush=function(){return void 0===b?w:p(n())},v}},{14:14,18:18,19:19}],12:[function(t,e){var i=t(6),n=t(20),s=/[&<>"']/g,r=RegExp(s.source);e.exports=function(t){return(t=n(t))&&r.test(t)?t.replace(s,i):t}},{20:20,6:6}],13:[function(t,e){var i=Array.isArray;e.exports=i},{}],14:[function(t,e){e.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},{}],15:[function(t,e){e.exports=function(t){return null!=t&&"object"==typeof t}},{}],16:[function(t,e){var i=t(3),n=t(13),s=t(15),r="[object String]";e.exports=function(t){return"string"==typeof t||!n(t)&&s(t)&&i(t)==r}},{13:13,15:15,3:3}],17:[function(t,e){var i=t(3),n=t(15),s="[object Symbol]";e.exports=function(t){return"symbol"==typeof t||n(t)&&i(t)==s}},{15:15,3:3}],18:[function(t,e){var i=t(10);e.exports=function(){return i.Date.now()}},{10:10}],19:[function(t,e){var i=t(14),n=t(17),s=0/0,r=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,u=/^0o[0-7]+$/i,a=parseInt;e.exports=function(t){if("number"==typeof t)return t;if(n(t))return s;if(i(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=i(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(r,"");var h=l.test(t);return h||u.test(t)?a(t.slice(2),h?2:8):o.test(t)?s:+t}},{14:14,17:17}],20:[function(t,e){var i=t(5);e.exports=function(t){return null==t?"":i(t)}},{5:5}],21:[function(t){"use strict";function e(t){i.each(r,function(e,i){t.on(e,function(t){t.originalEvent&&i.forEach(function(e){t[e]=t.originalEvent[e]})})})}var i=window.jQuery||window.Zepto,n=t(16),s=t(37),r={change:["added","removed","value"],"selectivity-change":["added","removed","value"],"selectivity-highlight":["id","item"],"selectivity-selected":["id","item"],"selectivity-selecting":["id","item"]};i.fn.selectivity=function(t,r){var o,l=Array.prototype.slice.call(arguments,1);return this.each(function(){var u=this.selectivity;if(u){if("data"===t?t=l.length?"setData":"getData":"val"===t||"value"===t?t=l.length?"setValue":"getValue":n(t)||(l=[t],t="setOptions"),!i.isFunction(u[t]))throw new Error("Unknown method: "+t);void 0===o&&(o=u[t].apply(u,l))}else if(n(t)){if("destroy"!==t)throw new Error("Cannot call method on element without Selectivity instance")}else{r=i.extend({},t,{element:this});var a=i(this);a.is("select")&&a.prop("multiple")&&(r.multiple=!0);var h=s.Inputs,c=r.inputType||(r.multiple?"Multiple":"Single");if(!i.isFunction(c)){if(!h[c])throw new Error("Unknown Selectivity input type: "+c);c=h[c]}this.selectivity=new c(r),e(a=i(this.selectivity.el)),void 0===o&&(o=a)}}),void 0===o?this:o},s.patchEvents=e,i.Selectivity=s},{16:16,37:37,jquery:"jquery"}],22:[function(t,e){"use strict";function i(t,e){for(;t&&!l(t,e);)t=t.parentElement;return t||null}function n(t,e){this.el=u(t.template("dropdown",{dropdownCssClass:t.options.dropdownCssClass,searchInputPlaceholder:t.options.searchInputPlaceholder,showSearchInput:e.showSearchInput})),this.resultsContainer=this.$(".selectivity-results-container"),this.hasMore=!1,this.highlightedResult=null,this.loadMoreHighlighted=!1,this.options=e,this.results=[],this.selectivity=t,this._closed=!1,this._lastMousePosition={},this.close=this.close.bind(this),this.position=this.position.bind(this),!1!==t.options.closeOnSelect&&t.events.on("selectivity-selecting",this.close),this.addToDom(),this.showLoading(),e.showSearchInput&&(t.initInput(this.$(".selectivity-search-input")),t.focus());var i={};i["click "+f]=this._loadMoreClicked,i["click "+p]=this._resultClicked,i["mouseenter "+f]=this._loadMoreHovered,i["mouseenter "+p]=this._resultHovered,this.events=new r(this.el,this),this.events.on(i),this._attachScrollListeners(),this._suppressWheel(),setTimeout(this.triggerOpen.bind(this),1)}var s=(window.jQuery||window.Zepto).extend,r=t(23),o=t(40),l=t(42),u=t(43),a=t(44),h=t(45),c=t(46),d=t(37),f=".selectivity-load-more",p=".selectivity-result-item",v=["scroll","touchend","touchmove"];s(n.prototype,{$:function(t){return this.el.querySelector(t)},addToDom:function(){this.selectivity.el.appendChild(this.el)},close:function(){this._closed||(this._closed=!0,a(this.el),this.selectivity.events.off("selectivity-selecting",this.close),this.triggerClose(),this._removeScrollListeners())},highlight:function(t,e){c(this.$(".highlight"),"highlight",!1),c(this.$(o(p,t.id)),"highlight",!0),this.highlightedResult=t,this.loadMoreHighlighted=!1,this.selectivity.triggerEvent("selectivity-highlight",{item:t,id:t.id,reason:e&&e.reason||"unspecified"})},highlightLoadMore:function(){c(this.$(".highlight"),"highlight",!1),c(this.$(f),"highlight",!0),this.highlightedResult=null,this.loadMoreHighlighted=!0},loadMore:function(){a(this.$(f)),this.resultsContainer.innerHTML+=this.selectivity.template("loading"),this.options.query({callback:function(t){if(!t||!t.results)throw new Error("callback must be passed a response object");this._showResults(d.processItems(t.results),{add:!0,hasMore:!!t.more})}.bind(this),error:this._showResults.bind(this,[],{add:!0}),offset:this.results.length,selectivity:this.selectivity,term:this.term})},position:function(){var t=this.options.position;t&&t(this.el,this.selectivity.el),this._scrolled()},renderItems:function(t){var e=this.selectivity;return t.map(function(t){var i=e.template(t.id?"resultItem":"resultLabel",t);return t.children&&(i+=e.template("resultChildren",{childrenHtml:this.renderItems(t.children)})),i},this).join("")},search:function(t){if(this.term=t,this.options.items){t=d.transformText(t);var e=this.selectivity.options.matcher||d.matcher;this._showResults(this.options.items.map(function(i){return e(i,t)}).filter(function(t){return!!t}),{term:t})}else this.options.query&&this.options.query({callback:function(e){if(!e||!e.results)throw new Error("callback must be passed a response object");this._showResults(d.processItems(e.results),{hasMore:!!e.more,term:t})}.bind(this),error:this.showError.bind(this),offset:0,selectivity:this.selectivity,term:t})},selectHighlight:function(){this.highlightedResult?this.selectItem(this.highlightedResult.id):this.loadMoreHighlighted&&this.loadMore()},selectItem:function(t){var e=d.findNestedById(this.results,t);if(e&&!e.disabled&&!1!==e.selectable){var i={id:t,item:e};this.selectivity.triggerEvent("selectivity-selecting",i)&&this.selectivity.triggerEvent("selectivity-selected",i)}},showError:function(t,e){this.resultsContainer.innerHTML=this.selectivity.template("error",{escape:!e||!1!==e.escape,message:t}),this.hasMore=!1,this.results=[],this.highlightedResult=null,this.loadMoreHighlighted=!1,this.position()},showLoading:function(){this.resultsContainer.innerHTML=this.selectivity.template("loading"),this.hasMore=!1,this.results=[],this.highlightedResult=null,this.loadMoreHighlighted=!1,this.position()},showResults:function(t,e){e.add?a(this.$(".selectivity-loading")):this.resultsContainer.innerHTML="";var i=this.selectivity.filterResults(t),n=this.renderItems(i);e.hasMore?n+=this.selectivity.template("loadMore"):n||e.add||(n=this.selectivity.template("noResults",{term:e.term})),this.resultsContainer.innerHTML+=n,this.results=e.add?this.results.concat(t):t,this.hasMore=e.hasMore;var s=this.selectivity.getValue();if(s&&!Array.isArray(s)){var r=d.findNestedById(t,s);r&&this.highlight(r,{reason:"current_value"})}else!1===this.options.highlightFirstItem||e.add&&!this.loadMoreHighlighted||this._highlightFirstItem(i);this.position()},triggerClose:function(){this.selectivity.triggerEvent("selectivity-close")},triggerOpen:function(){this.selectivity.triggerEvent("selectivity-open")},_attachScrollListeners:function(){for(var t=0;t<v.length;t++)window.addEventListener(v[t],this.position,!0);window.addEventListener("resize",this.position)},_highlightFirstItem:function(t){function e(t){for(var i=0,n=t.length;n>i;i++){var s=t[i];if(s.id)return s;if(s.children){var r=e(s.children);if(r)return r}}}var i=e(t);i?this.highlight(i,{reason:"first_result"}):(this.highlightedResult=null,this.loadMoreHighlighted=!1)},_loadMoreClicked:function(t){this.loadMore(),h(t)},_loadMoreHovered:function(t){void 0!==t.screenX&&t.screenX===this._lastMousePosition.x&&void 0!==t.screenY&&t.screenY===this._lastMousePosition.y||(this.highlightLoadMore(),this._recordMousePosition(t))},_recordMousePosition:function(t){this._lastMousePosition={x:t.screenX,y:t.screenY}},_removeScrollListeners:function(){for(var t=0;t<v.length;t++)window.removeEventListener(v[t],this.position,!0);window.removeEventListener("resize",this.position)},_resultClicked:function(t){this.selectItem(this.selectivity.getRelatedItemId(t)),h(t)},_resultHovered:function(t){if(!t.screenX||t.screenX!==this._lastMousePosition.x||!t.screenY||t.screenY!==this._lastMousePosition.y){var e=this.selectivity.getRelatedItemId(t),i=d.findNestedById(this.results,e);i&&!i.disabled&&this.highlight(i,{reason:"hovered"}),this._recordMousePosition(t)}},_scrolled:function(){var t=this.$(f);t&&t.offsetTop-this.resultsContainer.scrollTop<this.el.clientHeight&&this.loadMore()},_showResults:function(t,e){this.showResults(t,s({dropdown:this},e))},_suppressWheel:function(){var t=this.selectivity.options.suppressWheelSelector;if(null!==t){var e=t||".selectivity-results-container";this.events.on("wheel",e,function(t){function n(){h(t),t.preventDefault()}var s=0===t.deltaMode?t.deltaY:40*t.deltaY,r=i(t.target,e),o=r.clientHeight,l=r.scrollHeight,u=r.scrollTop;l>o&&(-u>s?(r.scrollTop=0,n()):s>l-o-u&&(r.scrollTop=l,n()))})}}}),e.exports=d.Dropdown=n},{23:23,37:37,40:40,42:42,43:43,44:44,45:45,46:46,"lodash/assign":"lodash/assign"}],23:[function(t,e){"use strict";function i(t,e){this.context=e||null,this.el=t,this.events={},this._onEvent=this._onEvent.bind(this)}var n=(window.jQuery||window.Zepto).extend,s=t(16),r=t(42),o=["blur","focus","mouseenter","mouseleave","scroll"];n(i.prototype,{destruct:function(){Object.keys(this.events).forEach(function(t){var e=o.indexOf(t)>-1;this.el.removeEventListener(t,this._onEvent,e)},this),this.context=null,this.el=null,this.events=null},off:function(t,e,i){if(s(e)||(i=e,e=""),i){var n=this.events[t];if(n&&(n=n[e]))for(var r=0;r<n.length;r++)n[r]===i&&(n.splice(r,1),r--)}else this.events[t][e]=[]},on:function(t,e,i){if(s(t)){if(s(e)||(i=e,e=""),!this.events.hasOwnProperty(t)){var n=o.indexOf(t)>-1;this.el.addEventListener(t,this._onEvent,n),this.events[t]={}}this.events[t].hasOwnProperty(e)||(this.events[t][e]=[]),this.events[t][e].indexOf(i)<0&&this.events[t][e].push(i)}else{var r=t;for(var l in r)if(r.hasOwnProperty(l)){var u=l.split(" ");u.length>1?this.on(u[0],u[1],r[l]):this.on(u[0],r[l])}}},_onEvent:function(t){function e(e){for(var i=0;i<e.length;i++)e[i].call(s,t)}var i=!1,n=t.stopPropagation;t.stopPropagation=function(){n.call(t),i=!0};for(var s=this.context,o=t.target,l=this.events[t.type.toLowerCase()];o&&o!==this.el&&!i;){for(var u in l)u&&l.hasOwnProperty(u)&&r(o,u)&&e(l[u]);o=o.parentElement}!i&&l.hasOwnProperty("")&&e(l[""])}}),e.exports=i},{16:16,42:42,"lodash/assign":"lodash/assign"}],24:[function(t,e){"use strict";function i(t){var e=t.indexOf("@");if(-1===e||t.indexOf(" ")>-1)return!1;var i=t.lastIndexOf(".");return-1===i?e<t.length-2:!(i>e)||i<t.length-2}function n(t,e){for(var i=(e=void 0===e?t.length:e)-1;i>=0;i--)if(/\s/.test(t[i]))return t.slice(i+1,e);return t.slice(0,e)}function s(t,e){return t.charAt(0)===e[0]&&t.slice(-1)===e[1]?t.slice(1,-1).trim():t.trim()}function r(t){var e=n(t),r=t.slice(0,-e.length).trim();return i(e)?(e=s(s(e,"()"),"<>"),r=s(r,'""').trim()||e,{id:e,text:r}):t.trim()?{id:t,text:t}:null}function o(t,e,s){for(;function(t){if(t)for(var e=0,s=t.length;s>e;e++)switch(t[e]){case";":case",":case"\n":return!0;case" ":case"	":if(i(n(t,e)))return!0;break;case'"':do e++;while(s>e&&'"'!==t[e]);break;default:continue}return!1}(t);){var o=function(t){for(var e=0,s=t.length;s>e;e++)switch(t[e]){case";":case",":case"\n":return{term:t.slice(0,e),input:t.slice(e+1)};case" ":case"	":if(i(n(t,e)))return{term:t.slice(0,e),input:t.slice(e+1)};break;case'"':do e++;while(s>e&&'"'!==t[e]);break;default:continue}return{}}(t);if(o.term){var l=r(o.term);!l||l.id&&h.findById(e,l.id)||s(l)}t=o.input}return t}function l(t){a.call(this,u({createTokenItem:r,showDropdown:!1,tokenizer:o},t)),this.events.on("blur",function(){var t=this.input;t&&i(n(t.value))&&this.add(r(t.value))})}var u=(window.jQuery||window.Zepto).extend,a=t(25),h=t(37);h.inherits(l,a),e.exports=h.Inputs.Email=l},{25:25,37:37,"lodash/assign":"lodash/assign"}],25:[function(t,e){"use strict";function i(t){r.call(this,n({positionDropdown:function(t,e){var i=e.getBoundingClientRect(),s=t.clientHeight,r=i.bottom+s>window.innerHeight&&i.top-s>0;n(t.style,{left:i.left+"px",top:(r?i.top-s:i.bottom)+"px",width:i.width+"px"})},showSearchInputInDropdown:!1},t)),this._reset();var e={change:this.rerenderSelection,click:this._clicked,"selectivity-selected":this._resultSelected};e["change "+d]=h,e["click "+f]=this._itemClicked,e["click "+f+"-remove"]=this._itemRemoveClicked,e["keydown "+d]=this._keyHeld,e["keyup "+d]=this._keyReleased,e["paste "+d]=this._onPaste,this.events.on(e)}var n=(window.jQuery||window.Zepto).extend,s=t(16),r=t(37),o=t(40),l=t(41),u=t(43),a=t(44),h=t(45),c=t(46),d=".selectivity-multiple-input",f=".selectivity-multiple-selected-item",p="ontouchstart"in window,v=r.inherits(i,r,{add:function(t){var e=r.isValidId(t),i=e?t:this.validateItem(t)&&t.id;-1===this._value.indexOf(i)&&(this._value.push(i),e&&this.options.initSelection?this.options.initSelection([i],function(e){this._value.indexOf(i)>-1&&(t=this.validateItem(e[0]),this._data.push(t),this.triggerChange({added:t}))}.bind(this)):(e&&(t=this.getItemForId(i)),this._data.push(t),this.triggerChange({added:t}))),this.input.value="",this._updateInputWidth()},clear:function(){this.setData([])},filterResults:function(t){return(t=t.map(function(t){var e={id:t.id,text:t.text};return t.children&&(e.children=this.filterResults(t.children)),e},this)).filter(function(t){return!r.findById(this._data,t.id)},this)},getDataForValue:function(t){return t.map(this.getItemForId,this).filter(function(t){return!!t})},getValueForData:function(t){return t.map(function(t){return t.id})},remove:function(t){var e,i=t.id||t,n=r.findIndexById(this._data,i);n>-1&&(e=this._data[n],this._data.splice(n,1)),this._value[n]!==i&&(n=this._value.indexOf(i)),n>-1&&this._value.splice(n,1),e&&this.triggerChange({removed:e}),i===this._highlightedItemId&&(this._highlightedItemId=null),this._updateInputWidth()},rerenderSelection:function(t){(t=t||{}).added?(this._renderSelectedItem(t.added),this._scrollToBottom()):t.removed?a(this.$(o(f,t.removed.id))):(this._forEachSelectedItem(a),this._data.forEach(this._renderSelectedItem,this),this._updateInputWidth()),(t.added||t.removed)&&(this.dropdown&&this.dropdown.showResults(this.filterResults(this.dropdown.results),{hasMore:this.dropdown.hasMore}),p||this.focus()),this.positionDropdown(),this._updatePlaceholder()},search:function(t){this.options.tokenizer&&(t=this.options.tokenizer(t,this._data,this.add.bind(this),this.options),s(t)&&t!==this.input.value&&(this.input.value=t)),this._updateInputWidth(),this.dropdown&&v(this,"search",t)},setOptions:function(t){var e=this.enabled;v(this,"setOptions",t),e!==this.enabled&&this._reset()},validateData:function(t){if(null===t)return[];if(Array.isArray(t))return t.map(this.validateItem,this);throw new Error("Data for MultiSelectivity instance should be an array")},validateValue:function(t){if(null===t)return[];if(Array.isArray(t)){if(t.every(r.isValidId))return t;throw new Error("Value contains invalid IDs")}throw new Error("Value for MultiSelectivity instance should be an array")},_backspacePressed:function(){this.options.backspaceHighlightsBeforeDelete?this._highlightedItemId?this._deletePressed():this._value.length&&this._highlightItem(this._value.slice(-1)[0]):this._value.length&&this.remove(this._value.slice(-1)[0])},_clicked:function(t){this.enabled&&(!1!==this.options.showDropdown?this.open():this.focus(),h(t))},_createToken:function(){var t=this.input.value,e=this.options.createTokenItem;if(t&&e){var i=e(t);i&&this.add(i)}},_deletePressed:function(){this._highlightedItemId&&this.remove(this._highlightedItemId)},_forEachSelectedItem:function(t){Array.prototype.forEach.call(this.el.querySelectorAll(f),t)},_highlightItem:function(t){this._highlightedItemId=t,this._forEachSelectedItem(function(e){c(e,"highlighted",e.getAttribute("data-item-id")===t)}),p||this.focus()},_itemClicked:function(t){this.enabled&&this._highlightItem(this.getRelatedItemId(t))},_itemRemoveClicked:function(t){this.remove(this.getRelatedItemId(t)),h(t)},_keyHeld:function(t){this._originalValue=this.input.value,13!==l(t)||t.ctrlKey||t.preventDefault()},_keyReleased:function(t){var e=!!this._originalValue,i=l(t);13!==i||t.ctrlKey?8!==i||e?46!==i||e||this._deletePressed():this._backspacePressed():this._createToken()},_onPaste:function(){setTimeout(function(){this.search(this.input.value),this._createToken()}.bind(this),10)},_renderSelectedItem:function(t){var e=u(this.template("multipleSelectedItem",n({highlighted:t.id===this._highlightedItemId,removable:!this.options.readOnly},t)));this.input.parentNode.insertBefore(e,this.input)},_reset:function(){this.el.innerHTML=this.template("multipleSelectInput",{enabled:this.enabled}),this._highlightedItemId=null,this.initInput(this.$(d)),this.rerenderSelection()},_resultSelected:function(t){-1===this._value.indexOf(t.id)?this.add(t.item):this.remove(t.item)},_scrollToBottom:function(){var t=this.$(d+"-container");t.scrollTop=t.clientHeight},_updateInputWidth:function(){if(this.enabled){var t=this.input.value||!this._data.length&&this.options.placeholder||"";this.input.setAttribute("size",t.length+2),this.positionDropdown()}},_updatePlaceholder:function(){var t=!this._data.length&&this.options.placeholder||"";this.enabled?this.input.setAttribute("placeholder",t):this.$(".selectivity-placeholder").textContent=t}});e.exports=r.Inputs.Multiple=i},{16:16,37:37,40:40,41:41,43:43,44:44,45:45,46:46,"lodash/assign":"lodash/assign"}],26:[function(t,e){"use strict";function i(t){s.call(this,n({positionDropdown:function(t,e){var i=e.getBoundingClientRect(),s=i.bottom,r=Math.min(Math.max(s+t.clientHeight-window.innerHeight,0),i.top+i.height);n(t.style,{left:i.left+"px",top:s-r+"px",width:i.width+"px"})}},t)),this.rerender(),!1===t.showSearchInputInDropdown&&this.initInput(this.$(".selectivity-single-select-input"),{search:!1}),this.events.on({change:this.rerenderSelection,click:this._clicked,"click .selectivity-search-input":r,"click .selectivity-single-selected-item-remove":this._itemRemoveClicked,"focus .selectivity-single-select-input":this._focused,"selectivity-selected":this._resultSelected})}var n=(window.jQuery||window.Zepto).extend,s=t(37),r=t(45),o=s.inherits(i,s,{clear:function(){this.setData(null)},close:function(t){this._closing=!0,o(this,"close"),t&&t.keepFocus&&this.input&&this.input.focus(),this._closing=!1},getDataForValue:function(t){return this.getItemForId(t)},getValueForData:function(t){return t?t.id:null},rerender:function(){this.el.innerHTML=this.template("singleSelectInput",this.options),this.rerenderSelection()},rerenderSelection:function(){var t=this._data?"singleSelectedItem":"singleSelectPlaceholder",e=this._data?n({removable:this.options.allowClear&&!this.options.readOnly},this._data):{placeholder:this.options.placeholder};this.el.querySelector("input").value=this._value,this.$(".selectivity-single-result-container").innerHTML=this.template(t,e)},setOptions:function(t){var e=this.enabled;o(this,"setOptions",t),e!==this.enabled&&this.rerender()},validateData:function(t){return null===t?t:this.validateItem(t)},validateValue:function(t){if(null===t||s.isValidId(t))return t;throw new Error("Value for SingleSelectivity instance should be a valid ID or null")},_clicked:function(){this.enabled&&(this.dropdown?this.close({keepFocus:!0}):!1!==this.options.showDropdown&&this.open())},_focused:function(){!this.enabled||this._closing||this._opening||!1===this.options.showDropdown||this.open()},_itemRemoveClicked:function(t){this.setData(null),r(t)},_resultSelected:function(t){this.setData(t.item),this.close({keepFocus:!0})}});e.exports=s.Inputs.Single=i},{37:37,45:45,"lodash/assign":"lodash/assign"}],27:[function(t,e){"use strict";var i=t(12),n=t(37);e.exports=n.Locale={loading:"Loading...",loadMore:"Load more...",noResults:"No results found",ajaxError:function(t){return t?"Failed to fetch results for <b>"+i(t)+"</b>":"Failed to fetch results"},needMoreCharacters:function(t){return"Enter "+t+" more characters to search"},noResultsForTerm:function(t){return"No results for <b>"+i(t)+"</b>"}}},{12:12,37:37}],28:[function(t){"use strict";function e(t,e,i){return t+(t.indexOf("?")>-1?"&":"?")+e+"="+encodeURIComponent(i)}function i(t,e){var i={};return e.forEach(function(e){void 0!==t[e]&&(i[e]=t[e])}),i}function n(t,n){var s=t.fetch||window.fetch,r=n.term,l="function"==typeof t.url?t.url(n):t.url;if(t.params){var u=t.params(r,n.offset||0);for(var a in u)u.hasOwnProperty(a)&&(l=e(l,a,u[a]))}s(l,i(t,["body","cache","credentials","headers","integrity","method","mode","redirect","referrer","referrerPolicy"]),n).then(function(t){if(t.ok)return t.json();if(Array.isArray(t)||t.results)return t;throw new Error("Unexpected AJAX response")}).then(function(t){n.callback(Array.isArray(t)?{results:t,more:!1}:{results:t.results,more:!!t.more})}).catch(function(e){var i=t.formatError||o.ajaxError;n.error(i(r,e),{escape:!1})})}var s=t(11),r=t(37),o=t(27);r.OptionListeners.unshift(function(t,e){var i=e.ajax;if(i&&i.url){var r=i.quietMillis?s(n,i.quietMillis):n;e.query=function(t){var e=i.minimumInputLength-t.term.length;e>0?t.error(o.needMoreCharacters(e)):r(i,t)}}})},{11:11,27:27,37:37}],29:[function(t){"use strict";var e=0;t(37).OptionListeners.push(function(t,i){var n=i.query;n&&!n._async&&(i.query=function(t){var i=++e,s=t.callback,r=t.error;t.callback=function(){i===e&&s.apply(null,arguments)},t.error=function(){i===e&&r.apply(null,arguments)},n(t)},i.query._async=!0)})},{37:37}],30:[function(t){"use strict";var e={"\u24b6":"A","\uff21":"A","\xc0":"A","\xc1":"A","\xc2":"A","\u1ea6":"A","\u1ea4":"A","\u1eaa":"A","\u1ea8":"A","\xc3":"A","\u0100":"A","\u0102":"A","\u1eb0":"A","\u1eae":"A","\u1eb4":"A","\u1eb2":"A","\u0226":"A","\u01e0":"A","\xc4":"A","\u01de":"A","\u1ea2":"A","\xc5":"A","\u01fa":"A","\u01cd":"A","\u0200":"A","\u0202":"A","\u1ea0":"A","\u1eac":"A","\u1eb6":"A","\u1e00":"A","\u0104":"A","\u023a":"A","\u2c6f":"A","\ua732":"AA","\xc6":"AE","\u01fc":"AE","\u01e2":"AE","\ua734":"AO","\ua736":"AU","\ua738":"AV","\ua73a":"AV","\ua73c":"AY","\u24b7":"B","\uff22":"B","\u1e02":"B","\u1e04":"B","\u1e06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24b8":"C","\uff23":"C","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\xc7":"C","\u1e08":"C","\u0187":"C","\u023b":"C","\ua73e":"C","\u24b9":"D","\uff24":"D","\u1e0a":"D","\u010e":"D","\u1e0c":"D","\u1e10":"D","\u1e12":"D","\u1e0e":"D","\u0110":"D","\u018b":"D","\u018a":"D","\u0189":"D","\ua779":"D","\u01f1":"DZ","\u01c4":"DZ","\u01f2":"Dz","\u01c5":"Dz","\u24ba":"E","\uff25":"E","\xc8":"E","\xc9":"E","\xca":"E","\u1ec0":"E","\u1ebe":"E","\u1ec4":"E","\u1ec2":"E","\u1ebc":"E","\u0112":"E","\u1e14":"E","\u1e16":"E","\u0114":"E","\u0116":"E","\xcb":"E","\u1eba":"E","\u011a":"E","\u0204":"E","\u0206":"E","\u1eb8":"E","\u1ec6":"E","\u0228":"E","\u1e1c":"E","\u0118":"E","\u1e18":"E","\u1e1a":"E","\u0190":"E","\u018e":"E","\u24bb":"F","\uff26":"F","\u1e1e":"F","\u0191":"F","\ua77b":"F","\u24bc":"G","\uff27":"G","\u01f4":"G","\u011c":"G","\u1e20":"G","\u011e":"G","\u0120":"G","\u01e6":"G","\u0122":"G","\u01e4":"G","\u0193":"G","\ua7a0":"G","\ua77d":"G","\ua77e":"G","\u24bd":"H","\uff28":"H","\u0124":"H","\u1e22":"H","\u1e26":"H","\u021e":"H","\u1e24":"H","\u1e28":"H","\u1e2a":"H","\u0126":"H","\u2c67":"H","\u2c75":"H","\ua78d":"H","\u24be":"I","\uff29":"I","\xcc":"I","\xcd":"I","\xce":"I","\u0128":"I","\u012a":"I","\u012c":"I","\u0130":"I","\xcf":"I","\u1e2e":"I","\u1ec8":"I","\u01cf":"I","\u0208":"I","\u020a":"I","\u1eca":"I","\u012e":"I","\u1e2c":"I","\u0197":"I","\u24bf":"J","\uff2a":"J","\u0134":"J","\u0248":"J","\u24c0":"K","\uff2b":"K","\u1e30":"K","\u01e8":"K","\u1e32":"K","\u0136":"K","\u1e34":"K","\u0198":"K","\u2c69":"K","\ua740":"K","\ua742":"K","\ua744":"K","\ua7a2":"K","\u24c1":"L","\uff2c":"L","\u013f":"L","\u0139":"L","\u013d":"L","\u1e36":"L","\u1e38":"L","\u013b":"L","\u1e3c":"L","\u1e3a":"L","\u0141":"L","\u023d":"L","\u2c62":"L","\u2c60":"L","\ua748":"L","\ua746":"L","\ua780":"L","\u01c7":"LJ","\u01c8":"Lj","\u24c2":"M","\uff2d":"M","\u1e3e":"M","\u1e40":"M","\u1e42":"M","\u2c6e":"M","\u019c":"M","\u24c3":"N","\uff2e":"N","\u01f8":"N","\u0143":"N","\xd1":"N","\u1e44":"N","\u0147":"N","\u1e46":"N","\u0145":"N","\u1e4a":"N","\u1e48":"N","\u0220":"N","\u019d":"N","\ua790":"N","\ua7a4":"N","\u01ca":"NJ","\u01cb":"Nj","\u24c4":"O","\uff2f":"O","\xd2":"O","\xd3":"O","\xd4":"O","\u1ed2":"O","\u1ed0":"O","\u1ed6":"O","\u1ed4":"O","\xd5":"O","\u1e4c":"O","\u022c":"O","\u1e4e":"O","\u014c":"O","\u1e50":"O","\u1e52":"O","\u014e":"O","\u022e":"O","\u0230":"O","\xd6":"O","\u022a":"O","\u1ece":"O","\u0150":"O","\u01d1":"O","\u020c":"O","\u020e":"O","\u01a0":"O","\u1edc":"O","\u1eda":"O","\u1ee0":"O","\u1ede":"O","\u1ee2":"O","\u1ecc":"O","\u1ed8":"O","\u01ea":"O","\u01ec":"O","\xd8":"O","\u01fe":"O","\u0186":"O","\u019f":"O","\ua74a":"O","\ua74c":"O","\u01a2":"OI","\ua74e":"OO","\u0222":"OU","\u24c5":"P","\uff30":"P","\u1e54":"P","\u1e56":"P","\u01a4":"P","\u2c63":"P","\ua750":"P","\ua752":"P","\ua754":"P","\u24c6":"Q","\uff31":"Q","\ua756":"Q","\ua758":"Q","\u024a":"Q","\u24c7":"R","\uff32":"R","\u0154":"R","\u1e58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1e5a":"R","\u1e5c":"R","\u0156":"R","\u1e5e":"R","\u024c":"R","\u2c64":"R","\ua75a":"R","\ua7a6":"R","\ua782":"R","\u24c8":"S","\uff33":"S","\u1e9e":"S","\u015a":"S","\u1e64":"S","\u015c":"S","\u1e60":"S","\u0160":"S","\u1e66":"S","\u1e62":"S","\u1e68":"S","\u0218":"S","\u015e":"S","\u2c7e":"S","\ua7a8":"S","\ua784":"S","\u24c9":"T","\uff34":"T","\u1e6a":"T","\u0164":"T","\u1e6c":"T","\u021a":"T","\u0162":"T","\u1e70":"T","\u1e6e":"T","\u0166":"T","\u01ac":"T","\u01ae":"T","\u023e":"T","\ua786":"T","\ua728":"TZ","\u24ca":"U","\uff35":"U","\xd9":"U","\xda":"U","\xdb":"U","\u0168":"U","\u1e78":"U","\u016a":"U","\u1e7a":"U","\u016c":"U","\xdc":"U","\u01db":"U","\u01d7":"U","\u01d5":"U","\u01d9":"U","\u1ee6":"U","\u016e":"U","\u0170":"U","\u01d3":"U","\u0214":"U","\u0216":"U","\u01af":"U","\u1eea":"U","\u1ee8":"U","\u1eee":"U","\u1eec":"U","\u1ef0":"U","\u1ee4":"U","\u1e72":"U","\u0172":"U","\u1e76":"U","\u1e74":"U","\u0244":"U","\u24cb":"V","\uff36":"V","\u1e7c":"V","\u1e7e":"V","\u01b2":"V","\ua75e":"V","\u0245":"V","\ua760":"VY","\u24cc":"W","\uff37":"W","\u1e80":"W","\u1e82":"W","\u0174":"W","\u1e86":"W","\u1e84":"W","\u1e88":"W","\u2c72":"W","\u24cd":"X","\uff38":"X","\u1e8a":"X","\u1e8c":"X","\u24ce":"Y","\uff39":"Y","\u1ef2":"Y","\xdd":"Y","\u0176":"Y","\u1ef8":"Y","\u0232":"Y","\u1e8e":"Y","\u0178":"Y","\u1ef6":"Y","\u1ef4":"Y","\u01b3":"Y","\u024e":"Y","\u1efe":"Y","\u24cf":"Z","\uff3a":"Z","\u0179":"Z","\u1e90":"Z","\u017b":"Z","\u017d":"Z","\u1e92":"Z","\u1e94":"Z","\u01b5":"Z","\u0224":"Z","\u2c7f":"Z","\u2c6b":"Z","\ua762":"Z","\u24d0":"a","\uff41":"a","\u1e9a":"a","\xe0":"a","\xe1":"a","\xe2":"a","\u1ea7":"a","\u1ea5":"a","\u1eab":"a","\u1ea9":"a","\xe3":"a","\u0101":"a","\u0103":"a","\u1eb1":"a","\u1eaf":"a","\u1eb5":"a","\u1eb3":"a","\u0227":"a","\u01e1":"a","\xe4":"a","\u01df":"a","\u1ea3":"a","\xe5":"a","\u01fb":"a","\u01ce":"a","\u0201":"a","\u0203":"a","\u1ea1":"a","\u1ead":"a","\u1eb7":"a","\u1e01":"a","\u0105":"a","\u2c65":"a","\u0250":"a","\ua733":"aa","\xe6":"ae","\u01fd":"ae","\u01e3":"ae","\ua735":"ao","\ua737":"au","\ua739":"av","\ua73b":"av","\ua73d":"ay","\u24d1":"b","\uff42":"b","\u1e03":"b","\u1e05":"b","\u1e07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24d2":"c","\uff43":"c","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\xe7":"c","\u1e09":"c","\u0188":"c","\u023c":"c","\ua73f":"c","\u2184":"c","\u24d3":"d","\uff44":"d","\u1e0b":"d","\u010f":"d","\u1e0d":"d","\u1e11":"d","\u1e13":"d","\u1e0f":"d","\u0111":"d","\u018c":"d","\u0256":"d","\u0257":"d","\ua77a":"d","\u01f3":"dz","\u01c6":"dz","\u24d4":"e","\uff45":"e","\xe8":"e","\xe9":"e","\xea":"e","\u1ec1":"e","\u1ebf":"e","\u1ec5":"e","\u1ec3":"e","\u1ebd":"e","\u0113":"e","\u1e15":"e","\u1e17":"e","\u0115":"e","\u0117":"e","\xeb":"e","\u1ebb":"e","\u011b":"e","\u0205":"e","\u0207":"e","\u1eb9":"e","\u1ec7":"e","\u0229":"e","\u1e1d":"e","\u0119":"e","\u1e19":"e","\u1e1b":"e","\u0247":"e","\u025b":"e","\u01dd":"e","\u24d5":"f","\uff46":"f","\u1e1f":"f","\u0192":"f","\ua77c":"f","\u24d6":"g","\uff47":"g","\u01f5":"g","\u011d":"g","\u1e21":"g","\u011f":"g","\u0121":"g","\u01e7":"g","\u0123":"g","\u01e5":"g","\u0260":"g","\ua7a1":"g","\u1d79":"g","\ua77f":"g","\u24d7":"h","\uff48":"h","\u0125":"h","\u1e23":"h","\u1e27":"h","\u021f":"h","\u1e25":"h","\u1e29":"h","\u1e2b":"h","\u1e96":"h","\u0127":"h","\u2c68":"h","\u2c76":"h","\u0265":"h","\u0195":"hv","\u24d8":"i","\uff49":"i","\xec":"i","\xed":"i","\xee":"i","\u0129":"i","\u012b":"i","\u012d":"i","\xef":"i","\u1e2f":"i","\u1ec9":"i","\u01d0":"i","\u0209":"i","\u020b":"i","\u1ecb":"i","\u012f":"i","\u1e2d":"i","\u0268":"i","\u0131":"i","\u24d9":"j","\uff4a":"j","\u0135":"j","\u01f0":"j","\u0249":"j","\u24da":"k","\uff4b":"k","\u1e31":"k","\u01e9":"k","\u1e33":"k","\u0137":"k","\u1e35":"k","\u0199":"k","\u2c6a":"k","\ua741":"k","\ua743":"k","\ua745":"k","\ua7a3":"k","\u24db":"l","\uff4c":"l","\u0140":"l","\u013a":"l","\u013e":"l","\u1e37":"l","\u1e39":"l","\u013c":"l","\u1e3d":"l","\u1e3b":"l","\u017f":"l","\u0142":"l","\u019a":"l","\u026b":"l","\u2c61":"l","\ua749":"l","\ua781":"l","\ua747":"l","\u01c9":"lj","\u24dc":"m","\uff4d":"m","\u1e3f":"m","\u1e41":"m","\u1e43":"m","\u0271":"m","\u026f":"m","\u24dd":"n","\uff4e":"n","\u01f9":"n","\u0144":"n","\xf1":"n","\u1e45":"n","\u0148":"n","\u1e47":"n","\u0146":"n","\u1e4b":"n","\u1e49":"n","\u019e":"n","\u0272":"n","\u0149":"n","\ua791":"n","\ua7a5":"n","\u01cc":"nj","\u24de":"o","\uff4f":"o","\xf2":"o","\xf3":"o","\xf4":"o","\u1ed3":"o","\u1ed1":"o","\u1ed7":"o","\u1ed5":"o","\xf5":"o","\u1e4d":"o","\u022d":"o","\u1e4f":"o","\u014d":"o","\u1e51":"o","\u1e53":"o","\u014f":"o","\u022f":"o","\u0231":"o","\xf6":"o","\u022b":"o","\u1ecf":"o","\u0151":"o","\u01d2":"o","\u020d":"o","\u020f":"o","\u01a1":"o","\u1edd":"o","\u1edb":"o","\u1ee1":"o","\u1edf":"o","\u1ee3":"o","\u1ecd":"o","\u1ed9":"o","\u01eb":"o","\u01ed":"o","\xf8":"o","\u01ff":"o","\u0254":"o","\ua74b":"o","\ua74d":"o","\u0275":"o","\u01a3":"oi","\u0223":"ou","\ua74f":"oo","\u24df":"p","\uff50":"p","\u1e55":"p","\u1e57":"p","\u01a5":"p","\u1d7d":"p","\ua751":"p","\ua753":"p","\ua755":"p","\u24e0":"q","\uff51":"q","\u024b":"q","\ua757":"q","\ua759":"q","\u24e1":"r","\uff52":"r","\u0155":"r","\u1e59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1e5b":"r","\u1e5d":"r","\u0157":"r","\u1e5f":"r","\u024d":"r","\u027d":"r","\ua75b":"r","\ua7a7":"r","\ua783":"r","\u24e2":"s","\uff53":"s","\xdf":"s","\u015b":"s","\u1e65":"s","\u015d":"s","\u1e61":"s","\u0161":"s","\u1e67":"s","\u1e63":"s","\u1e69":"s","\u0219":"s","\u015f":"s","\u023f":"s","\ua7a9":"s","\ua785":"s","\u1e9b":"s","\u24e3":"t","\uff54":"t","\u1e6b":"t","\u1e97":"t","\u0165":"t","\u1e6d":"t","\u021b":"t","\u0163":"t","\u1e71":"t","\u1e6f":"t","\u0167":"t","\u01ad":"t","\u0288":"t","\u2c66":"t","\ua787":"t","\ua729":"tz","\u24e4":"u","\uff55":"u","\xf9":"u","\xfa":"u","\xfb":"u","\u0169":"u","\u1e79":"u","\u016b":"u","\u1e7b":"u","\u016d":"u","\xfc":"u","\u01dc":"u","\u01d8":"u","\u01d6":"u","\u01da":"u","\u1ee7":"u","\u016f":"u","\u0171":"u","\u01d4":"u","\u0215":"u","\u0217":"u","\u01b0":"u","\u1eeb":"u","\u1ee9":"u","\u1eef":"u","\u1eed":"u","\u1ef1":"u","\u1ee5":"u","\u1e73":"u","\u0173":"u","\u1e77":"u","\u1e75":"u","\u0289":"u","\u24e5":"v","\uff56":"v","\u1e7d":"v","\u1e7f":"v","\u028b":"v","\ua75f":"v","\u028c":"v","\ua761":"vy","\u24e6":"w","\uff57":"w","\u1e81":"w","\u1e83":"w","\u0175":"w","\u1e87":"w","\u1e85":"w","\u1e98":"w","\u1e89":"w","\u2c73":"w","\u24e7":"x","\uff58":"x","\u1e8b":"x","\u1e8d":"x","\u24e8":"y","\uff59":"y","\u1ef3":"y","\xfd":"y","\u0177":"y","\u1ef9":"y","\u0233":"y","\u1e8f":"y","\xff":"y","\u1ef7":"y","\u1e99":"y","\u1ef5":"y","\u01b4":"y","\u024f":"y","\u1eff":"y","\u24e9":"z","\uff5a":"z","\u017a":"z","\u1e91":"z","\u017c":"z","\u017e":"z","\u1e93":"z","\u1e95":"z","\u01b6":"z","\u0225":"z","\u0240":"z","\u2c6c":"z","\ua763":"z","\u0386":"\u0391","\u0388":"\u0395","\u0389":"\u0397","\u038a":"\u0399","\u03aa":"\u0399","\u038c":"\u039f","\u038e":"\u03a5","\u03ab":"\u03a5","\u038f":"\u03a9","\u03ac":"\u03b1","\u03ad":"\u03b5","\u03ae":"\u03b7","\u03af":"\u03b9","\u03ca":"\u03b9","\u0390":"\u03b9","\u03cc":"\u03bf","\u03cd":"\u03c5","\u03cb":"\u03c5","\u03b0":"\u03c5","\u03c9":"\u03c9","\u03c2":"\u03c3"},i=t(37),n=i.transformText;
i.transformText=function(t){for(var i="",s=0,r=t.length;r>s;s++){var o=t[s];i+=e[o]||o}return n(i)}},{37:37}],31:[function(t){"use strict";var e=window.jQuery||window.Zepto;t(37).OptionListeners.unshift(function(t,i){var n=i.ajax;n&&n.url&&!n.fetch&&e.Deferred&&(n.fetch=function(t,i){return e.ajax(t,{cache:"no-cache"!==i.cache,headers:i.headers||null,method:i.method||"GET",xhrFields:"include"===i.credentials?{withCredentials:!0}:null}).then(function(t){return{results:e.map(t,function(t){return t}),more:!1}},function(t,e,i){throw new Error("AJAX request returned: "+e+(i?", "+i:""))})})})},{37:37,jquery:"jquery"}],32:[function(t){"use strict";function e(t,e){var i=e.multiple?[]:null,s=function(){var t=n(this);if(t.is("option")){var r=t.text(),o=t.attr("value");if(void 0===o&&(o=r),t.prop("selected")){var l={id:o,text:r};e.multiple?i.push(l):i=l}return{id:o,text:t.attr("label")||r}}return{text:t.attr("label"),children:t.children("option,optgroup").map(s).get()}};e.allowClear="allowClear"in e?e.allowClear:!t.prop("required");var r=t.children("option,optgroup").map(s).get();e.data=i,e.items=e.query?null:r,e.placeholder=e.placeholder||t.data("placeholder")||"",e.tabIndex=void 0===e.tabIndex?t.attr("tabindex")||0:e.tabIndex;var o=(t.attr("class")||"selectivity-input").split(" ");o.indexOf("selectivity-input")<0&&o.push("selectivity-input");var l=n("<div>").attr({id:"s9y_"+t.attr("id"),"class":o.join(" "),style:t.attr("style"),"data-name":t.attr("name")});return l.insertAfter(t),t.hide(),l[0]}function i(t){var e=n(t.el);e.on("change",function(t){var i=t.originalEvent.value;e.prev("select").val("array"===n.type(i)?i.slice(0):i).trigger(t)})}var n=window.jQuery||window.Zepto,s=t(37);s.OptionListeners.push(function(t,r){var o=n(t.el);o.is("select")&&(o.attr("autofocus")&&setTimeout(function(){t.focus()},1),t.el=e(o,r),t.el.selectivity=t,s.patchEvents(o),i(t))})},{37:37,jquery:"jquery"}],33:[function(t){"use strict";var e=t(37),i=t(39),n=t(41),s=8,r=40,o=13,l=27,u=9,a=38;e.InputListeners.push(function(t,h){function c(n,s){function r(){var t;n.highlightedResult?t=i(l,n.highlightedResult.id):n.loadMoreHighlighted&&(t=n.$(".selectivity-load-more")),t&&t.scrollIntoView&&t.scrollIntoView(0>s)}var o=n.results;if(o.length){var l=[].slice.call(n.el.querySelectorAll(".selectivity-result-item"));if(n.submenu)c(n.submenu,s);else{var u=s>0?0:l.length-1,a=u,h=n.highlightedResult;if(h){var d=i(l,h.id);if(a=l.indexOf(d)+s,s>0?a>=l.length:0>a){if(n.hasMore)return n.highlightLoadMore(),void r();a=u}}var f=l[a],p=e.findNestedById(o,t.getRelatedItemId(f));p&&(n.highlight(p,{delay:!!p.submenu}),r())}}}var d=!1,f=null;h.addEventListener("keydown",function(e){var i=t.dropdown;if(i){var l=n(e);if(l===s){if(!h.value){if(i.submenu){for(var p=i.submenu;p.submenu;)p=p.submenu;f=p}e.preventDefault(),d=!0}}else l===r?c(i,1):l===a?c(i,-1):l===u?setTimeout(function(){t.close()},1):l===o&&e.preventDefault()}}),h.addEventListener("keyup",function(e){function i(){!1!==t.options.showDropdown&&t.open()}var u=t.dropdown,h=n(e);d?(e.preventDefault(),d=!1,f&&(f.close(),t.focus(),f=null)):h===s?!u&&t.options.allowClear&&t.clear():h!==o||e.ctrlKey?h===l?(t.close(),e.preventDefault()):h===r||h===a?(i(),e.preventDefault()):i():(u?u.selectHighlight():!1!==t.options.showDropdown&&i(),e.preventDefault())})})},{37:37,39:39,41:41}],34:[function(t,e){"use strict";function i(t,e){this.parentMenu=e.parentMenu,n.call(this,t,e),this._closeSubmenuTimeout=0,this._openSubmenuTimeout=0}var n=t(22),s=t(37),r=t(39),o=s.inherits(i,n,{close:function(){this.submenu&&this.submenu.close(),o(this,"close"),this.parentMenu&&(this.parentMenu.submenu=null,this.parentMenu=null),clearTimeout(this._closeSubmenuTimeout),clearTimeout(this._openSubmenuTimeout)},highlight:function(t,e){var i=(e=e||{}).reason||"unspecified";e.delay?(o(this,"highlight",t),clearTimeout(this._openSubmenuTimeout),this._openSubmenuTimeout=setTimeout(this._doHighlight.bind(this,t,i),300)):this.submenu?this.highlightedResult&&this.highlightedResult.id===t.id?this._doHighlight(t,i):(clearTimeout(this._closeSubmenuTimeout),this._closeSubmenuTimeout=setTimeout(this._closeSubmenuAndHighlight.bind(this,t,i),100)):(this.parentMenu&&this.parentMenu._closeSubmenuTimeout&&(clearTimeout(this.parentMenu._closeSubmenuTimeout),this.parentMenu._closeSubmenuTimeout=0),!1===e.openSubmenu?o(this,"highlight",t):this._doHighlight(t,i))},search:function(t){if(this.submenu){var e=this.$(".selectivity-search-input");if(!e||e!==document.activeElement)return void this.submenu.search(t);this.submenu.close()}o(this,"search",t)},selectHighlight:function(){this.submenu?this.submenu.selectHighlight():o(this,"selectHighlight")},showResults:function(t,e){function i(t){t.children&&t.children.forEach(i),t.submenu&&(t.selectable=!!t.selectable)}this.submenu&&e.dropdown!==this?this.submenu.showResults(t,e):(t.forEach(i),o(this,"showResults",t,e))},triggerClose:function(){this.parentMenu?this.selectivity.triggerEvent("selectivity-close-submenu"):o(this,"triggerClose")},triggerOpen:function(){this.parentMenu?this.selectivity.triggerEvent("selectivity-open-submenu"):o(this,"triggerOpen")},_closeSubmenuAndHighlight:function(t,e){this.submenu&&this.submenu.close(),this._doHighlight(t,e)},_doHighlight:function(t,e){o(this,"highlight",t);var i=this.selectivity.options;if(!(!t.submenu||this.submenu||i.shouldOpenSubmenu&&!1===i.shouldOpenSubmenu(t,e))){var n=i.dropdown||s.Dropdown;if(n){var l=this.el.querySelectorAll(".selectivity-result-item"),u=r(l,t.id),a=this.el;this.submenu=new n(this.selectivity,{highlightFirstItem:!t.selectable,items:t.submenu.items||null,parentMenu:this,position:function(e,i){if(t.submenu.positionDropdown)t.submenu.positionDropdown(e,i,u,a);else{var n=a.getBoundingClientRect(),s=n.right,r=n.width;s+r>document.body.clientWidth&&n.left-r>0&&(s=n.left-r+10);var o=u.getBoundingClientRect().top,l=Math.min(Math.max(o+e.clientHeight-window.innerHeight,0),n.top+n.height);e.style.left=s+"px",e.style.top=o-l+"px",e.style.width=r+"px"}},query:t.submenu.query||null,showSearchInput:t.submenu.showSearchInput}),this.submenu.search("")}}}});s.Dropdown=i,e.exports=i},{22:22,37:37,39:39}],35:[function(t){"use strict";function e(t,e,i,s){for(var r=s.createTokenItem||function(t){return t?{id:t,text:t}:null},o=s.tokenSeparators;function(t){return!!t&&o.some(function(e){return t.indexOf(e)>-1})}(t);){var l=function(t){for(var e=0,i=t.length;i>e;e++)if(o.indexOf(t[e])>-1)return{term:t.slice(0,e),input:t.slice(e+1)};return{}}(t);if(l.term){var u=r(l.term);u&&!n.findById(e,u.id)&&i(u)}t=l.input}return t}var i=(window.jQuery||window.Zepto).extend,n=t(37);n.OptionListeners.push(function(t,n){n.tokenSeparators&&(n.allowedTypes=i({tokenSeparators:"array"},n.allowedTypes),n.tokenizer=n.tokenizer||e)})},{37:37,"lodash/assign":"lodash/assign"}],36:[function(t){t(22),t(24),t(25),t(26),t(27),t(28),t(29),t(30),t(31),t(32),t(33),t(34),t(35),t(38),t(21)},{21:21,22:22,24:24,25:25,26:26,27:27,28:28,29:29,30:30,31:31,32:32,33:33,34:34,35:35,38:38}],37:[function(t,e){"use strict";function i(t){this.dropdown=null,this.el=t.element,this.enabled=!t.readOnly&&!t.removeOnly,this.input=null,this.items=null,this.options={},this.templates=n({},i.Templates),this.term="",this.setOptions(t),t.value?this.setValue(t.value,{triggerChange:!1}):this.setData(t.data||null,{triggerChange:!1}),this.el.setAttribute("tabindex",t.tabIndex||0),this.events=new r(this.el,this),this.events.on({blur:this._blur,mouseenter:this._mouseenter,mouseleave:this._mouseleave,"selectivity-close":this._closed})}var n=(window.jQuery||window.Zepto).extend,s=t(16),r=t(23),o=t(46);n(i.prototype,{$:function(t){return this.el.querySelector(t)},close:function(){this._clearCloseTimeout(),this.dropdown&&(this.dropdown.close(),this.dropdown=null)},destroy:function(){this.events.destruct();for(var t=this.el;t.firstChild;)t.removeChild(t.firstChild);t.selectivity=null},filterResults:function(t){return t},focus:function(){this._clearCloseTimeout(),this._focusing=!0,this.input&&this.input.focus(),this._focusing=!1},getData:function(){return this._data},getItemForId:function(t){var e=this.items;return e?i.findNestedById(e,t):null===t?null:{id:t,text:""+t}},getRelatedItemId:function(t){for(var e=t.target||t;e&&!e.hasAttribute("data-item-id");)e=e.parentNode;if(!e)return null;var n=e.getAttribute("data-item-id");if(i.findById(this._data||[],n))return n;for(var s=this.dropdown;s;){if(i.findNestedById(s.results,n))return n;s=s.submenu}var r=parseInt(n,10);return""+r===n?r:n},getValue:function(){return this._value},initInput:function(t,e){this.input=t;var n=this;(this.options.inputListeners||i.InputListeners).forEach(function(i){i(n,t,e)}),e&&!1===e.search||t.addEventListener("keyup",function(t){t.defaultPrevented||n.search(t.target.value)})},open:function(){if(!this._opening&&!this.dropdown&&this.triggerEvent("selectivity-opening")){this._opening=!0;var t=this.options.dropdown||i.Dropdown;t&&(this.dropdown=new t(this,{items:this.items,position:this.options.positionDropdown,query:this.options.query,showSearchInput:!1!==this.options.showSearchInputInDropdown})),this.search(""),this.focus(),o(this.el,"open",!0),this._opening=!1}},positionDropdown:function(){this.dropdown&&this.dropdown.position()},search:function(t){this.open(),this.dropdown&&this.dropdown.search(t)},setData:function(t,e){e=e||{},t=this.validateData(t),this._data=t,this._value=this.getValueForData(t),!1!==e.triggerChange&&this.triggerChange()},setOptions:function(t){t=t||{};var e=this;i.OptionListeners.forEach(function(i){i(e,t)}),"items"in t&&(this.items=t.items?i.processItems(t.items):null),"templates"in t&&n(this.templates,t.templates),n(this.options,t),this.enabled=!this.options.readOnly&&!this.options.removeOnly},setValue:function(t,e){e=e||{},t=this.validateValue(t),this._value=t,this.options.initSelection?this.options.initSelection(t,function(i){this._value===t&&(this._data=this.validateData(i),!1!==e.triggerChange&&this.triggerChange())}.bind(this)):(this._data=this.getDataForValue(t),!1!==e.triggerChange&&this.triggerChange())},template:function(t,e){var i=this.templates[t];if(!i)throw new Error("Unknown template: "+t);if("function"==typeof i){var n=i(e);return"string"==typeof n?n.trim():n}return i.render?i.render(e).trim():i.toString().trim()},triggerChange:function(t){var e=n({data:this._data,value:this._value},t);this.triggerEvent("change",e),this.triggerEvent("selectivity-change",e)},triggerEvent:function(t,e){var i=document.createEvent("Event");return i.initEvent(t,!1,!0),n(i,e),this.el.dispatchEvent(i),!i.defaultPrevented},validateItem:function(t){if(t&&i.isValidId(t.id)&&s(t.text))return t;throw new Error("Item should have id (number or string) and text (string) properties")},_blur:function(){this._focusing||this.el.classList.contains("hover")||(this._clearCloseTimeout(),this._closeTimeout=setTimeout(this.close.bind(this),166))},_clearCloseTimeout:function(){this._closeTimeout&&(clearTimeout(this._closeTimeout),this._closeTimeout=0)},_closed:function(){this.dropdown=null,o(this.el,"open",!1)},_mouseleave:function(t){this.el.contains(t.relatedTarget)||o(this.el,"hover",!1)},_mouseenter:function(){o(this.el,"hover",!0)}}),i.Dropdown=null,i.InputListeners=[],i.Inputs={},i.OptionListeners=[],i.Templates={},i.findById=function(t,e){var n=i.findIndexById(t,e);return n>-1?t[n]:null},i.findIndexById=function(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i].id===e)return i;return-1},i.findNestedById=function(t,e){for(var n=0,s=t.length;s>n;n++){var r,o=t[n];if(o.id===e?r=o:o.children?r=i.findNestedById(o.children,e):o.submenu&&o.submenu.items&&(r=i.findNestedById(o.submenu.items,e)),r)return r}return null},i.inherits=function(t,e,i){return t.prototype=n(Object.create(e.prototype),{constructor:t},i),function(t,i){e.prototype[i].apply(t,Array.prototype.slice.call(arguments,2))}},i.isValidId=function(t){return"number"==typeof t||s(t)},i.matcher=function(t,e){var n=null;if(i.transformText(t.text).indexOf(e)>-1)n=t;else if(t.children){var s=t.children.map(function(t){return i.matcher(t,e)}).filter(function(t){return!!t});s.length&&(n={id:t.id,text:t.text,children:s})}return n},i.processItem=function(t){if(i.isValidId(t))return{id:t,text:""+t};if(t&&(i.isValidId(t.id)||t.children)&&s(t.text))return t.children&&(t.children=i.processItems(t.children)),t;throw new Error("invalid item")},i.processItems=function(t){if(Array.isArray(t))return t.map(i.processItem);throw new Error("invalid items")},i.transformText=function(t){return t.toLowerCase()},e.exports=i},{16:16,23:23,46:46,"lodash/assign":"lodash/assign"}],38:[function(t){"use strict";var e=t(12),i=t(37),n=t(27);i.Templates={dropdown:function(t){var i=t.dropdownCssClass?" "+t.dropdownCssClass:"",n="";if(t.showSearchInput){i+=" has-search-input";var s=t.searchInputPlaceholder;n='<div class="selectivity-search-input-container"><input type="text" class="selectivity-search-input"'+(s?' placeholder="'+e(s)+'"':"")+"></div>"}return'<div class="selectivity-dropdown'+i+'">'+n+'<div class="selectivity-results-container"></div></div>'},error:function(t){return'<div class="selectivity-error">'+(t.escape?e(t.message):t.message)+"</div>"},loading:function(){return'<div class="selectivity-loading">'+n.loading+"</div>"},loadMore:function(){return'<div class="selectivity-load-more">'+n.loadMore+"</div>"},multipleSelectInput:function(t){return'<div class="selectivity-multiple-input-container">'+(t.enabled?'<input type="text" autocomplete="off" autocorrect="off" autocapitalize="off" class="selectivity-multiple-input">':'<div class="selectivity-multiple-input selectivity-placeholder"></div>')+'<div class="selectivity-clearfix"></div></div>'},multipleSelectedItem:function(t){return'<span class="selectivity-multiple-selected-item'+(t.highlighted?" highlighted":"")+'" data-item-id="'+e(t.id)+'">'+(t.removable?'<a class="selectivity-multiple-selected-item-remove"><i class="fa fa-remove"></i></a>':"")+e(t.text)+"</span>"},noResults:function(t){return'<div class="selectivity-error">'+(t.term?n.noResultsForTerm(t.term):n.noResults)+"</div>"},resultChildren:function(t){return'<div class="selectivity-result-children">'+t.childrenHtml+"</div>"},resultItem:function(t){return'<div class="selectivity-result-item'+(t.disabled?" disabled":"")+'" data-item-id="'+e(t.id)+'">'+e(t.text)+(t.submenu?'<i class="selectivity-submenu-icon fa fa-chevron-right"></i>':"")+"</div>"},resultLabel:function(t){return'<div class="selectivity-result-label">'+e(t.text)+"</div>"},singleSelectInput:function(t){return'<div class="selectivity-single-select"><input type="text" class="selectivity-single-select-input"'+(t.required?" required":"")+'><div class="selectivity-single-result-container"></div><i class="fa fa-sort-desc selectivity-caret"></i></div>'},singleSelectPlaceholder:function(t){return'<div class="selectivity-placeholder">'+e(t.placeholder)+"</div>"},singleSelectedItem:function(t){return'<span class="selectivity-single-selected-item" data-item-id="'+e(t.id)+'">'+(t.removable?'<a class="selectivity-single-selected-item-remove"><i class="fa fa-remove"></i></a>':"")+e(t.text)+"</span>"},selectCompliance:function(t){var e=t.mode,i=t.name;return"multiple"===e&&"[]"!==i.slice(-2)&&(i+="[]"),'<select name="'+i+'"'+("multiple"===e?" multiple":"")+"></select>"},selectOptionCompliance:function(t){return'<option value="'+e(t.id)+'" selected>'+e(t.text)+"</option>"}}},{12:12,27:27,37:37}],39:[function(t,e){"use strict";e.exports=function(t,e){for(var i=0,n=t.length;n>i;i++){var s=t[i],r=s.getAttribute("data-item-id");if(("number"==typeof e?parseInt(r,10):r)===e)return s}return null}},{}],40:[function(t,e){"use strict";e.exports=function(t,e){return t+"[data-item-id="+('"'+(""+e).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"')+"]"}},{}],41:[function(t,e){"use strict";e.exports=function(t){return t.which||t.keyCode||0}},{}],42:[function(t,e){"use strict";e.exports=function(t,e){return(t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector).call(t,e)}},{}],43:[function(t,e){"use strict";e.exports=function(t){var e=document.createElement("div");return e.innerHTML=t,e.firstChild}},{}],44:[function(t,e){"use strict";e.exports=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)}},{}],45:[function(t,e){"use strict";e.exports=function(t){t.stopPropagation()}},{}],46:[function(t,e){"use strict";e.exports=function(t,e,i){t&&t.classList[i?"add":"remove"](e)}},{}]},{},[36])(36)});